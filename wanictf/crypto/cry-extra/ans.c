#include<stdio.h>
#include<gmp.h>

#define N_str "22255382023772668851018179427844169178508638456713544208965498667359965716247243217931028270320680101854437928939452335472153643094266035953797432826168426002458800906764442624308120284177094975740468163835305872963635678413995878812492729432260346481442092245748885202467992527408086207041964831622724073720751839241897580988210971776031098476500998975223039782371635291859483569580516707907602619018780393060215756966917504096971372578145138070121288608502379649804953835336933545368863853793291348412017384228807171466141787383764812064465152885522264261710104646819565161405416285530129398700414912821358924882993"
#define M_str "455054308184393892678058040417894434538147052966484655368629806848690951585316383741818991249942897131402174931069148907410409095241197004639436085265522674198117934494409967755516107042868190564732371162423204135770802585390754508661199283919569348449653439331457503898545517122035939648918370853985174413495"
#define C_str "17228720052381175899005296327529228647857019551986416863927209013417483505116054978735086007753554984554590706212543316457002993598203960172630351581308428981923248377333772786232057445880572046104706039330059467410587857287022959518047526287362946817619717880614820138792149370198936936857422116461146587380005750298216662907558653796277806259062461884502203484610534512552197338982682870358910558302016481352035443274153409114492025483995668048818103066011831955626539382173160900595378864729936791103356604330731386911513668727994911216530875480647283550078311836214338646991447576725034118526046292574067040720093"
int main(){
    mpz_t N;
    mpz_t M;
    mpz_t Q1,Q2,Q;
    mpz_t P;
    mpz_t tmp1,tmp2;
    mpz_t order;
    mpz_t sec;
    mpz_t e;
    mpz_t C;

    mpz_init(N);
    mpz_init(M);
    mpz_init(P);
    mpz_init(Q);
    mpz_init(Q1);
    mpz_init(Q2);
    mpz_init(tmp1);
    mpz_init(tmp2);
    mpz_init(e);
    mpz_init(order);
    mpz_init(sec);
    mpz_init(C);



    mpz_set_str(N,N_str,10);
    mpz_set_str(M,M_str,10);
    mpz_set_ui(e,65537);
    mpz_set_str(C,C_str,10);
    
    //(M^2-4*2N)^(1/2)
    mpz_pow_ui(tmp1,M,2);
    mpz_mul_ui(tmp2,N,8);
    mpz_sub(tmp1,tmp1,tmp2);
    mpz_sqrt(tmp1,tmp1);
    
    //Q1
    mpz_add(Q1,M,tmp1);
    mpz_div_ui(Q1,Q1,2);

    //Q2
    mpz_sub(Q2,M,tmp1);
    mpz_div_ui(Q2,Q2,2);
    

    mpz_set(Q,Q2);
    mpz_div(P,N,Q);
    mpz_sub_ui(tmp1,Q,1);
    mpz_sub_ui(tmp2,P,1);
    mpz_mul(order,tmp1,tmp2);
    mpz_invert(sec,e,order);
    mpz_powm(C,C,sec,N);
    gmp_printf("sec=%Zd",C);






    
}